# Nacos-Learning 项目规范

## 技术栈要求

### 必须使用的技术
1. **数据库**: 必须使用 MySQL，禁止使用其他数据库（如 PostgreSQL、MongoDB 等）
2. **消息中间件**: 必须使用 RocketMQ，禁止使用其他消息中间件（如 RabbitMQ、Kafka 等）
3. **微服务架构**: 必须使用 Spring Cloud 生态
4. **服务发现与配置中心**: 必须使用 Nacos
5. **API 网关**: 必须使用 Spring Cloud Gateway
6. **服务间通信**: 必须使用 OpenFeign 进行服务间调用

### 版本要求
- Java: 1.8
- Spring Boot: 2.7.18
- Spring Cloud: 2021.0.9
- Spring Cloud Alibaba: 2021.0.5.0
- MySQL Connector: 8.0.33

## 项目结构规范

### 模块命名规范
- 服务模块命名: `{service-name}-service` (如: `user-service`, `order-service`)
- 通用模块命名: `nacos-{module-name}` (如: `nacos-common`, `nacos-gateway`)
- 配置示例目录: `nacos-config-examples`

### 包结构规范
- 基础包名: `com.zxx.learning`
- Controller 层: `com.zxx.learning.{module}.controller`
- Service 层: `com.zxx.learning.{module}.service`
- Feign 客户端: `com.zxx.learning.{module}.feign`
- 配置类: `com.zxx.learning.{module}.config`
- 实体类: `com.zxx.learning.common.entity` (放在 common 模块)

## 依赖管理规范

### 必须包含的依赖
1. **所有服务模块必须包含**:
   - `spring-cloud-starter-alibaba-nacos-discovery` (服务发现)
   - `spring-cloud-starter-alibaba-nacos-config` (配置中心)
   - `spring-boot-starter-web` (Web 支持)

2. **需要服务间调用的模块必须包含**:
   - `spring-cloud-starter-openfeign` (OpenFeign)

3. **需要消息队列的模块必须包含**:
   - `spring-cloud-starter-alibaba-rocketmq` (RocketMQ)

4. **需要数据库的模块必须包含**:
   - `mysql-connector-java` (MySQL 驱动)
   - `spring-boot-starter-jdbc` 或 `spring-boot-starter-data-jpa` (数据库支持)

5. **Gateway 模块必须包含**:
   - `spring-cloud-starter-gateway` (Gateway)
   - `spring-boot-starter-data-redis-reactive` (Redis 限流)

### 禁止使用的依赖
- 禁止使用 `spring-cloud-starter-netflix-eureka` (必须使用 Nacos)
- 禁止使用 `spring-cloud-starter-config` (必须使用 Nacos Config)
- 禁止使用 `spring-cloud-starter-zuul` (必须使用 Gateway)
- 禁止使用其他数据库驱动（如 PostgreSQL、MongoDB）
- 禁止使用其他消息中间件（如 RabbitMQ、Kafka）

## 配置规范

### Nacos 配置要求
- 所有服务必须配置 Nacos 服务发现
- 所有服务必须配置 Nacos 配置中心
- 配置文件名格式: `nacos-{service-name}-{profile}.yaml` (如: `nacos-provider-dev.yaml`)
- 配置必须放在 `nacos-config-examples` 目录下作为示例

### 数据库配置要求
- 数据源配置必须在 Nacos 配置中心中
- 必须使用 MySQL 数据库
- 连接池建议使用 HikariCP (Spring Boot 默认)

### Gateway 路由配置要求
- 路由配置必须在 `application.yml` 中
- 必须配置服务发现路由
- 必须配置限流规则（使用 Redis）
- 必须配置 CORS 跨域支持

## 代码规范

### Feign 客户端规范
- Feign 客户端接口必须放在 `feign` 包下
- 接口命名: `{ServiceName}Client` (如: `UserServiceClient`)
- 必须使用 `@FeignClient` 注解，指定 `name` 或 `value` 为服务名

### 服务间调用规范
- 服务间调用必须使用 OpenFeign，禁止使用 RestTemplate 或 WebClient
- Feign 客户端必须通过 Nacos 服务发现进行调用

### 消息队列使用规范
- 消息发送必须使用 RocketMQ
- 消息生产者类命名: `{Entity}MessageProducer`
- 消息消费者类命名: `{Entity}MessageConsumer`
- 必须使用 `@RocketMQMessageListener` 注解配置消费者

## 检查清单

在添加新模块或修改现有代码时，请确保：
- [ ] 使用了 MySQL 数据库（不是其他数据库）
- [ ] 使用了 RocketMQ 消息中间件（不是其他 MQ）
- [ ] 集成了 Nacos 服务发现
- [ ] 集成了 Nacos 配置中心
- [ ] 如果是 Gateway 模块，使用了 Spring Cloud Gateway
- [ ] 服务间调用使用了 OpenFeign
- [ ] 配置了正确的依赖版本
- [ ] 遵循了包结构规范
- [ ] 在 Nacos 配置中心添加了对应的配置文件

## AI 助手提示

当用户请求添加新功能或修改代码时：
1. 如果用户要求使用其他数据库，提醒必须使用 MySQL
2. 如果用户要求使用其他消息中间件，提醒必须使用 RocketMQ
3. 如果用户要求使用其他服务发现组件，提醒必须使用 Nacos
4. 如果用户要求使用其他网关，提醒必须使用 Spring Cloud Gateway
5. 确保所有新模块都正确集成了 Nacos 和 OpenFeign
6. 确保依赖版本符合项目要求
